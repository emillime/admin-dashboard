import{s as ce,r as Ae,n as ee,o as Be,i as Oe,b as fe,h as ve}from"../chunks/scheduler.a70eca57.js";import{S as ue,i as me,g as w,m as M,s as O,r as re,h as D,j as I,n as R,f as b,c as H,u as le,x as Je,k as x,a as F,y as i,v as se,A as ke,o as j,d as Y,t as K,w as ne,e as ie,B as He,b as Me,z as we,p as Re}from"../chunks/index.fec47d3a.js";import{a as Pe,l as Ce}from"../chunks/localDb.52dd18f1.js";import{f as Fe}from"../chunks/utils.dec7ddc5.js";import{e as de}from"../chunks/each.13dd49ab.js";import{e as De}from"../chunks/index.f1d07f17.js";import{D as L,a as Le}from"../chunks/api.75b8bb29.js";import{F as Te}from"../chunks/fa.28829ef6.js";import{_ as ye}from"../chunks/preload-helper.41c905a7.js";import{g as Ve}from"../chunks/jwtUtils.fbb3dbd8.js";function Ie(r,t,o){const e=r.slice();return e[4]=t[o],e}function xe(r,t,o){const e=r.slice();return e[7]=t[o],e}function Ee(r){let t,o=de(r[1]),e=[];for(let a=0;a<o.length;a+=1)e[a]=$e(Ie(r,o,a));return{c(){for(let a=0;a<e.length;a+=1)e[a].c();t=ie()},l(a){for(let s=0;s<e.length;s+=1)e[s].l(a);t=ie()},m(a,s){for(let l=0;l<e.length;l+=1)e[l]&&e[l].m(a,s);F(a,t,s)},p(a,s){if(s&2){o=de(a[1]);let l;for(l=0;l<o.length;l+=1){const f=Ie(a,o,l);e[l]?e[l].p(f,s):(e[l]=$e(f),e[l].c(),e[l].m(t.parentNode,t))}for(;l<e.length;l+=1)e[l].d(1);e.length=o.length}},d(a){a&&b(t),He(e,a)}}}function Se(r){let t=r[7].quantity+"",o,e,a=r[7].productName+"",s,l,f;return{c(){o=M(t),e=O(),s=M(a),l=O(),f=w("br")},l(d){o=R(d,t),e=H(d),s=R(d,a),l=H(d),f=D(d,"BR",{})},m(d,u){F(d,o,u),F(d,e,u),F(d,s,u),F(d,l,u),F(d,f,u)},p(d,u){u&2&&t!==(t=d[7].quantity+"")&&j(o,t),u&2&&a!==(a=d[7].productName+"")&&j(s,a)},d(d){d&&(b(o),b(e),b(s),b(l),b(f))}}}function $e(r){let t,o,e,a=`${L.fromJSDate(r[4].startTime).toFormat("HH:mm")} - ${L.fromJSDate(r[4].endTime).toFormat("HH:mm")}`,s,l,f,d,u=r[4].bookingId.customerInfo.firstName+"",g,n,p=r[4].bookingId.customerInfo.lastName+"",c,E,$,S,B,T=r[4].bookingId.customerInfo.mobile+"",q,G,P,N,W,A=de(Object.values(r[4].bookingId.priceObject.products)),h=[];for(let m=0;m<A.length;m+=1)h[m]=Se(xe(r,A,m));return{c(){t=w("tr"),o=w("td"),e=w("span"),s=M(a),l=O(),f=w("td"),d=w("span"),g=M(u),n=O(),c=M(p),E=O(),$=w("td"),S=w("a"),B=M("+"),q=M(T),P=O(),N=w("td");for(let m=0;m<h.length;m+=1)h[m].c();W=O(),this.h()},l(m){t=D(m,"TR",{});var v=I(t);o=D(v,"TD",{class:!0});var _=I(o);e=D(_,"SPAN",{class:!0});var J=I(e);s=R(J,a),J.forEach(b),_.forEach(b),l=H(v),f=D(v,"TD",{class:!0});var V=I(f);d=D(V,"SPAN",{class:!0});var z=I(d);g=R(z,u),n=H(z),c=R(z,p),z.forEach(b),V.forEach(b),E=H(v),$=D(v,"TD",{class:!0});var Q=I($);S=D(Q,"A",{href:!0});var y=I(S);B=R(y,"+"),q=R(y,T),y.forEach(b),Q.forEach(b),P=H(v),N=D(v,"TD",{class:!0});var X=I(N);for(let k=0;k<h.length;k+=1)h[k].l(X);X.forEach(b),W=H(v),v.forEach(b),this.h()},h(){x(e,"class","text-slate-600"),x(o,"class","border-t-0 px-6 align-middle border-l-0 border-r-0 text-xs whitespace-nowrap p-4 text-left"),x(d,"class","font-bold text-slate-600"),x(f,"class","border-t-0 px-6 align-middle border-l-0 border-r-0 text-xs whitespace-nowrap p-4 text-left"),x(S,"href",G="tel:+"+r[4].bookingId.customerInfo.mobile),x($,"class","border-t-0 px-6 align-middle border-l-0 border-r-0 text-xs whitespace-nowrap p-4"),x(N,"class","border-t-0 px-6 align-middle border-l-0 border-r-0 text-xs whitespace-nowrap p-4 text-left")},m(m,v){F(m,t,v),i(t,o),i(o,e),i(e,s),i(t,l),i(t,f),i(f,d),i(d,g),i(d,n),i(d,c),i(t,E),i(t,$),i($,S),i(S,B),i(S,q),i(t,P),i(t,N);for(let _=0;_<h.length;_+=1)h[_]&&h[_].m(N,null);i(t,W)},p(m,v){if(v&2&&a!==(a=`${L.fromJSDate(m[4].startTime).toFormat("HH:mm")} - ${L.fromJSDate(m[4].endTime).toFormat("HH:mm")}`)&&j(s,a),v&2&&u!==(u=m[4].bookingId.customerInfo.firstName+"")&&j(g,u),v&2&&p!==(p=m[4].bookingId.customerInfo.lastName+"")&&j(c,p),v&2&&T!==(T=m[4].bookingId.customerInfo.mobile+"")&&j(q,T),v&2&&G!==(G="tel:+"+m[4].bookingId.customerInfo.mobile)&&x(S,"href",G),v&2){A=de(Object.values(m[4].bookingId.priceObject.products));let _;for(_=0;_<A.length;_+=1){const J=xe(m,A,_);h[_]?h[_].p(J,v):(h[_]=Se(J),h[_].c(),h[_].m(N,null))}for(;_<h.length;_+=1)h[_].d(1);h.length=A.length}},d(m){m&&b(t),He(h,m)}}}function qe(r){var X;let t,o,e,a,s,l=((X=r[1])==null?void 0:X.length)+"",f,d,u,g,n,p,c,E=`${L.fromJSDate(r[0]).toRelativeCalendar()}`,$,S,B,T=r[0].toLocaleDateString()+"",q,G,P,N,W,A,h,m,v='<tr><th class="px-6 align-middle border border-solid py-3 text-xs uppercase border-l-0 border-r-0 whitespace-nowrap font-semibold text-left bg-slate-50 text-slate-500 border-slate-100">Tid</th> <th class="px-6 align-middle border border-solid py-3 text-xs uppercase border-l-0 border-r-0 whitespace-nowrap font-semibold text-left bg-slate-50 text-slate-500 border-slate-100">Namn</th> <th class="px-6 align-middle border border-solid py-3 text-xs uppercase border-l-0 border-r-0 whitespace-nowrap font-semibold text-left bg-slate-50 text-slate-500 border-slate-100">Telefonnummer</th> <th class="px-6 align-middle border border-solid py-3 text-xs uppercase border-l-0 border-r-0 whitespace-nowrap font-semibold text-left bg-slate-50 text-slate-500 border-slate-100">Antal</th></tr>',_,J,V,z,Q;n=new Te({props:{icon:De,rotate:180,size:"1.5x"}}),N=new Te({props:{icon:De,size:"1.5x"}});let y=r[1]&&Ee(r);return{c(){t=w("div"),o=w("div"),e=w("div"),a=w("h3"),s=M("Bokningar ("),f=M(l),d=M(")"),u=O(),g=w("button"),re(n.$$.fragment),p=O(),c=w("h3"),$=M(E),S=O(),B=w("span"),q=M(T),G=O(),P=w("button"),re(N.$$.fragment),W=O(),A=w("div"),h=w("table"),m=w("thead"),m.innerHTML=v,_=O(),J=w("tbody"),y&&y.c(),this.h()},l(k){t=D(k,"DIV",{class:!0});var C=I(t);o=D(C,"DIV",{class:!0});var Z=I(o);e=D(Z,"DIV",{class:!0});var U=I(e);a=D(U,"H3",{class:!0});var te=I(a);s=R(te,"Bokningar ("),f=R(te,l),d=R(te,")"),te.forEach(b),u=H(U),g=D(U,"BUTTON",{class:!0});var be=I(g);le(n.$$.fragment,be),be.forEach(b),p=H(U),c=D(U,"H3",{class:!0});var ae=I(c);$=R(ae,E),S=H(ae),B=D(ae,"SPAN",{class:!0});var pe=I(B);q=R(pe,T),pe.forEach(b),ae.forEach(b),G=H(U),P=D(U,"BUTTON",{class:!0});var he=I(P);le(N.$$.fragment,he),he.forEach(b),U.forEach(b),Z.forEach(b),W=H(C),A=D(C,"DIV",{class:!0});var _e=I(A);h=D(_e,"TABLE",{class:!0});var oe=I(h);m=D(oe,"THEAD",{["data-svelte-h"]:!0}),Je(m)!=="svelte-140iagi"&&(m.innerHTML=v),_=H(oe),J=D(oe,"TBODY",{});var ge=I(J);y&&y.l(ge),ge.forEach(b),oe.forEach(b),_e.forEach(b),C.forEach(b),this.h()},h(){x(a,"class","mr-4 font-semibold text-lg text-slate-700"),x(g,"class","m-1 text-sky-600 hover:text-sky-900"),x(B,"class","pointer-events-none absolute -top-7 left-0 w-max opacity-0 transition-opacity group-hover:opacity-90 bg-sky-200 rounded-md text-sm"),x(c,"class","font-semibold text-lg text-slate-700 group relative"),x(P,"class","m-1 text-sky-600 hover:text-sky-900"),x(e,"class","flex flex-wrap items-center"),x(o,"class","rounded-t mb-0 px-4 py-3 border-0"),x(h,"class","items-center w-full bg-transparent border-collapse"),x(A,"class","block w-full overflow-x-auto"),x(t,"class","relative flex flex-col min-w-0 break-words w-full mb-6 shadow-lg rounded bg-white")},m(k,C){F(k,t,C),i(t,o),i(o,e),i(e,a),i(a,s),i(a,f),i(a,d),i(e,u),i(e,g),se(n,g,null),i(e,p),i(e,c),i(c,$),i(c,S),i(c,B),i(B,q),i(e,G),i(e,P),se(N,P,null),i(t,W),i(t,A),i(A,h),i(h,m),i(h,_),i(h,J),y&&y.m(J,null),V=!0,z||(Q=[ke(g,"click",r[2]),ke(P,"click",r[3])],z=!0)},p(k,[C]){var Z;(!V||C&2)&&l!==(l=((Z=k[1])==null?void 0:Z.length)+"")&&j(f,l),(!V||C&1)&&E!==(E=`${L.fromJSDate(k[0]).toRelativeCalendar()}`)&&j($,E),(!V||C&1)&&T!==(T=k[0].toLocaleDateString()+"")&&j(q,T),k[1]?y?y.p(k,C):(y=Ee(k),y.c(),y.m(J,null)):y&&(y.d(1),y=null)},i(k){V||(Y(n.$$.fragment,k),Y(N.$$.fragment,k),V=!0)},o(k){K(n.$$.fragment,k),K(N.$$.fragment,k),V=!1},d(k){k&&b(t),ne(n),ne(N),y&&y.d(),z=!1,Ae(Q)}}}function je(r,t,o){let{date:e}=t,{bookings:a}=t;function s(){e.setDate(e.getDate()-1),o(0,e)}function l(){e.setDate(e.getDate()+1),o(0,e)}return r.$$set=f=>{"date"in f&&o(0,e=f.date),"bookings"in f&&o(1,a=f.bookings)},[e,a,s,l]}class Ge extends ue{constructor(t){super(),me(this,t,je,qe,ce,{date:0,bookings:1})}}function ze(r){let t;return{c(){t=w("div")},l(o){t=D(o,"DIV",{}),I(t).forEach(b)},m(o,e){F(o,t,e),r[3](t)},p:ee,i:ee,o:ee,d(o){o&&b(t),r[3](null)}}}function Ue(r,t,o){let e,a=ee,s=()=>(a(),a=Oe(f,c=>o(6,e=c)),f);r.$$.on_destroy.push(()=>a());let{date:l}=t,{bookings:f}=t;s();let d,u,g;Be(async()=>{d=(await ye(()=>import("../chunks/index.571c4133.js"),[],import.meta.url)).SvelteGantt,u=(await ye(()=>import("../chunks/index.571c4133.js"),[],import.meta.url)).SvelteGanttTable;const c=await n();let E=L.now().toMillis(),$={headers:[{unit:"day",format:"dd/MM/yyyy"},{unit:"hour",format:"hh:mm"}],rows:c.rows,tasks:c.tasks,timeRanges:[{id:0,from:E,to:E+6e4,label:"Nu",enableResizing:!1}],columnUnit:"hour",columnOffset:1,magnetOffset:0,rowHeight:50,rowPadding:6,fitWidth:!0,minWidth:2500,from:L.fromJSDate(l).startOf("day").toMillis(),to:L.fromJSDate(l).endOf("day").toMillis(),tableWidth:75,tableHeaders:[{title:"",property:"label",width:100,type:"tree"}],ganttTableModules:[u]};const S=new d({target:g,props:$});setTimeout(()=>{S.scrollToTask(3,"smooth")},5e3)});async function n(){const c=Ve()??"",$=(await Le(c)).map(T=>({id:Number(T.slot),enableDragging:!1,label:`Slot ${T.slot}`,height:50,expanded:!1}));let S=0;const B=e==null?void 0:e.map(T=>({id:S++,amountDone:50,from:T.startTime,to:T.endTime,label:`${T.bookingId.customerInfo.firstName} ${T.bookingId.customerInfo.lastName}`,showButton:!1,enableDragging:!1,resourceId:Number(T.productSlotId.slot)}));return{rows:$,tasks:B}}function p(c){fe[c?"unshift":"push"](()=>{g=c,o(1,g)})}return r.$$set=c=>{"date"in c&&o(2,l=c.date),"bookings"in c&&s(o(0,f=c.bookings))},[f,g,l,p]}class We extends ue{constructor(t){super(),me(this,t,Ue,ze,ce,{date:2,bookings:0})}}function Ne(r){let t,o,e,a,s,l;function f(n){r[5](n)}let d={bookings:r[3]};r[0]!==void 0&&(d.date=r[0]),t=new We({props:d}),fe.push(()=>we(t,"date",f));function u(n){r[6](n)}let g={bookings:r[2]};return r[0]!==void 0&&(g.date=r[0]),a=new Ge({props:g}),fe.push(()=>we(a,"date",u)),{c(){re(t.$$.fragment),e=O(),re(a.$$.fragment)},l(n){le(t.$$.fragment,n),e=H(n),le(a.$$.fragment,n)},m(n,p){se(t,n,p),F(n,e,p),se(a,n,p),l=!0},p(n,p){const c={};p&8&&(c.bookings=n[3]),!o&&p&1&&(o=!0,c.date=n[0],ve(()=>o=!1)),t.$set(c);const E={};p&4&&(E.bookings=n[2]),!s&&p&1&&(s=!0,E.date=n[0],ve(()=>s=!1)),a.$set(E)},i(n){l||(Y(t.$$.fragment,n),Y(a.$$.fragment,n),l=!0)},o(n){K(t.$$.fragment,n),K(a.$$.fragment,n),l=!1},d(n){n&&b(e),ne(t,n),ne(a,n)}}}function Ye(r){let t,o,e=r[1]&&Ne(r);return{c(){e&&e.c(),t=ie()},l(a){e&&e.l(a),t=ie()},m(a,s){e&&e.m(a,s),F(a,t,s),o=!0},p(a,[s]){a[1]?e?(e.p(a,s),s&2&&Y(e,1)):(e=Ne(a),e.c(),Y(e,1),e.m(t.parentNode,t)):e&&(Re(),K(e,1,1,()=>{e=null}),Me())},i(a){o||(Y(e),o=!0)},o(a){K(e),o=!1},d(a){a&&b(t),e&&e.d(a)}}}function Ke(r,t,o){let e,a,s,l,f=ee,d=()=>(f(),f=Oe(a,p=>o(1,l=p)),a);r.$$.on_destroy.push(()=>f());let u=L.now().startOf("day").toJSDate();function g(p){u=p,o(0,u)}function n(p){u=p,o(0,u)}return r.$$.update=()=>{r.$$.dirty&1&&o(4,e=L.fromJSDate(u).endOf("day").toJSDate()),r.$$.dirty&17&&d(o(3,a=Pe(async()=>Ce.bookings.where("startTime").aboveOrEqual(u).and(p=>p.startTime<=e).toArray()))),r.$$.dirty&2&&o(2,s=l!=null?Fe(l):[])},[u,l,s,a,e,g,n]}class nt extends ue{constructor(t){super(),me(this,t,Ke,Ye,ce,{})}}export{nt as component};
